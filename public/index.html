<!doctype html>
<html class="theme-next   use-motion ">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.4.5.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="iyihua" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.4.5.2" />






<meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="iyihua">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="iyihua">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="iyihua">
<meta name="twitter:description">



<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: '',
    sidebar: 'post',
    motion: true
  };
</script>

  <title> iyihua </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->
  






  <div class="container one-column 
   page-home 
">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">iyihua</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首頁
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            歸檔
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            標籤
          </a>
        </li>
      

      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          
  <section id="posts" class="posts-expand">

    

    
    

    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/09/java-static-关键字总结/" itemprop="url">
                  java static 关键字总结
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-05-09T00:11:19+08:00" content="2016-05-09">
              2016-05-09
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h2><h3 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h3><p>修饰方法时，表示该方法是静态方法，表示该类的该方法可以不产生实例而直接通过类名加方法名的方法去执行该静态方法；</p>
<h3 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h3><p>修饰变量时，表示该变量是静态变量，在java里可以理解为静态变量全局变量。<br>该类的所有实例共享此静态变量，类装载时，只会分配一块存储空间，所有此类对象可以操作此块存储空间。<br>也就是说，static修饰的静态变量也是可以直接通过类名加变量名直接使用的</p>
<h3 id="3"><a href="#3" class="headerlink" title="3."></a>3.</h3><p>普通类不允许被声明为静态的，只有一个内部类可以。<br>被声明为静态的内部类，可以直接作为一个普通类来使用，而不需要一个外部类了。</p>
<h2 id="详述："><a href="#详述：" class="headerlink" title="详述："></a>详述：</h2><h3 id="1-1"><a href="#1-1" class="headerlink" title="1."></a>1.</h3><p> static表示“全局”或者“静态”的意思，用来修饰成员变量和成员方法，也可以形成静态static代码块，但是Java语言中没有全局变量的概念。 </p>
<p>　被static修饰的成员变量和成员方法独立于该类的任何对象。也就是说，它不依赖类特定的实例，被类的所有实例共享。只要这个类被加载，Java虚拟机就能根据类名在运行时数据区的方法区内定找到他们。因此，static对象可以在它的任何对象创建之前访问，无需引用任何对象。 </p>
<p>　用public修饰的static成员变量和成员方法本质是全局变量和全局方法，当声明它类的对象时，不生成static变量的副本，而是类的所有实例共享同一个static变量。 </p>
<p>　static 变量前可以有private修饰，表示这个变量可以在类的静态代码块中，或者类的其他静态成员方法中使用（当然也可以在非静态成员方法中使用–废话），但是不能在其他类中通过类名来直接引用，这一点很重要。实际上你需要搞明白，private是访问权限限定，static表示不要实例化就可以使用，这样就容易理解多了。static前面加上其它访问权限关键字的效果也以此类推。 </p>
<p>　static修饰的成员变量和成员方法习惯上称为静态变量和静态方法，可以直接通过类名来访问，访问语法为：<br>类名.静态方法名(参数列表…)<br>类名.静态变量名 </p>
<p>　用static修饰的代码块表示静态代码块，当Java虚拟机（JVM）加载类时，就会执行该代码块（用处非常大，呵呵）。 </p>
<h3 id="2-static变量"><a href="#2-static变量" class="headerlink" title="2.static变量"></a>2.static变量</h3><p>　按照是否静态的对类成员变量进行分类可分两种：一种是被static修饰的变量，叫静态变量或类变量；另一种是没有被static修饰的变量，叫实例变量。两者的区别是：<br>　对于静态变量在内存中只有一个拷贝（节省内存），JVM只为静态分配一次内存，在加载类的过程中完成静态变量的内存分配，可用类名直接访问（方便），当然也可以通过对象来访问（但是这是不推荐的）。<br>　对于实例变量，没创建一个实例，就会为实例变量分配一次内存，实例变量可以在内存中有多个拷贝，互不影响（灵活）。 </p>
<h3 id="3-static方法"><a href="#3-static方法" class="headerlink" title="3.static方法"></a>3.static方法</h3><p>　静态方法可以直接通过类名调用，任何的实例也都可以调用，因此静态方法中不能用this和super关键字，不能直接访问所属类的实例变量和实例方法 (就是不带static的成员变量和成员成员方法)，只能访问所属类的静态成员变量和成员方法。因为实例成员与特定的对象关联！这个需要去理解，想明白其中的道理，不是记忆！！！<br>　因为static方法独立于任何实例，因此static方法必须被实现，而不能是抽象的abstract。</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/08/java-enum-典型用法/" itemprop="url">
                  [java][enum]典型用法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-05-08T23:57:31+08:00" content="2016-05-08">
              2016-05-08
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h2 id="java-enum典型用法"><a href="#java-enum典型用法" class="headerlink" title="java enum典型用法"></a>java enum典型用法</h2><h3 id="代码："><a href="#代码：" class="headerlink" title="代码："></a>代码：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">package com.iyihua.model.enums;&#10;&#10;import java.util.HashMap;&#10;import java.util.Map;&#10;&#10;public enum GroupType &#123;&#10;&#10;     CATEGORY(0, &#34;category&#34;), PROJECT(1, &#34;project&#34;), LOCATION(2, &#34;location&#34; );&#10;&#10;     private final int id;&#10;     private final String key;&#10;&#10;     GroupType(int id, String key) &#123;&#10;            this. id = id;&#10;            this. key = key;&#10;     &#125;&#10;     &#10;     public int getId() &#123;&#10;            return id;&#10;     &#125;&#10;     public String getKey() &#123;&#10;            return key;&#10;     &#125;&#10;&#10;     private static final Map&#60;String, GroupType&#62; keyToEnum = new HashMap&#60;String, GroupType&#62;();&#10;     static &#123;&#10;            for (GroupType gt : GroupType. values())&#10;                 keyToEnum.put(gt .getKey(), gt );&#10;     &#125;&#10;&#10;     public static GroupType fromString(String symbol) &#123;&#10;            return keyToEnum.get(symbol );&#10;     &#125;&#10;&#10;     public static void main(String[] args) &#123;&#10;           System. out.println( fromString(&#34;category&#34;));&#10;     &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<h3 id="说明："><a href="#说明：" class="headerlink" title="说明："></a>说明：</h3><p>代码中把枚举值对应的string-枚举放到了一个map keyToEnum中，并且是静态化的。<br>如此就可以通过fromString方法，传入key string值，即可返回对应的enum值</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/08/java-design-pattern-java设计模式之Builder模式/" itemprop="url">
                  [java][design-pattern]java设计模式之Builder模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-05-08T16:58:38+08:00" content="2016-05-08">
              2016-05-08
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h2 id="java设计模式之Builder模式"><a href="#java设计模式之Builder模式" class="headerlink" title="java设计模式之Builder模式"></a>java设计模式之Builder模式</h2><p>设计模式模式很多，实际常用的很少。<br>《Effective Java》这本书里提到过的一种模式builder模式，个人认为非常值得推荐。<br>假设有一个entity(Entity)，有id，name两个字段，如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">package demo;&#10;public class Entity &#123;&#10;    private int id;&#10;    private String name;&#10;    public int getId() &#123;&#10;        return id;&#10;    &#125;&#10;    public void setId(int id) &#123;&#10;        this.id = id;&#10;    &#125;&#10;    public String getName() &#123;&#10;        return name;&#10;    &#125;&#10;    public void setName(String name) &#123;&#10;        this.name = name;&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>为了不用每次初始化的时候，要一个一个的setxxx设置字段值，通常我们会创建构造函数，通过构造函数直接传入字段，初始化。<br>加入构造函数的实体代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public class Entity &#123;&#10;    private int id;&#10;    private String name;&#10;    public Entity() &#123;&#10;        super();&#10;    &#125;&#10;    public Entity(int id, String name) &#123;&#10;        super();&#10;        this.id = id;&#10;        this.name = name;&#10;    &#125;&#10;    public int getId() &#123;&#10;        return id;&#10;    &#125;&#10;    public void setId(int id) &#123;&#10;        this.id = id;&#10;    &#125;&#10;    public String getName() &#123;&#10;        return name;&#10;    &#125;&#10;    public void setName(String name) &#123;&#10;        this.name = name;&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>然后需要初始化实体的时候，我们这样做：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Entity entity = new Entity(1, &#34;name&#34;);</span><br></pre></td></tr></table></figure></p>
<p>这种用法很常用，但是问题来了。<br>当实体Entity的字段需要增加变化的时候怎么办呢？<br>比如增加字段descr，这样构造函数和客户端初始化都需要更新：<br>实体增加：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">private String descr;&#10;public String getDescr() &#123;&#10;    return descr;&#10;&#125;&#10;public void setDescr(String descr) &#123;&#10;    this.descr = descr;&#10;&#125;&#10;public Entity(int id, String name, String descr) &#123;&#10;    super();&#10;    this.id = id;&#10;    this.name = name;&#10;    this.descr = descr;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>然后原来调用构造函数初始化的代码也需要改动：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Entity entity = new Entity(1, &#34;name&#34;, &#34;descr&#34;);</span><br></pre></td></tr></table></figure></p>
<p>如果你的class是不确定的参数，后续可能经常变动，那么你的构造函数可能需要很多个，并且不停的变动，而且，构造函数参数多的时候，参数也很不容易记住。</p>
<p>而Effective Java中则推荐一种builder模式来进行实体初始化<br>如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public class Entity &#123;&#10;    private int id;&#10;    private String name;&#10;    private String descr;&#10;    public static class Builder &#123;&#10;        private int id;&#10;        private String name;&#10;        private String descr;&#10;        public Builder(int id) &#123;&#10;            this.id = id;&#10;        &#125;&#10;        public Builder name(String name) &#123;&#10;            this.name = name;&#10;            return this;&#10;        &#125;&#10;        public Builder descr(String descr) &#123;&#10;            this.descr = descr;&#10;            return this;&#10;        &#125;&#10;        public Entity build() &#123;&#10;            return new Entity(this);&#10;        &#125;&#10;    &#125;&#10;    private Entity(Builder b) &#123;&#10;        this.id = b.id;&#10;        this.name = b.name;&#10;        this.descr = b.descr;&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>初始化实例的时候，如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Entity entity = new Entity.Builder(10).name(&#34;name&#34;).descr(&#34;descr&#34;).build();</span><br></pre></td></tr></table></figure></p>
<p>这样的写法，好处是，假如实体Entity以后变化很大，加入很多字段，不会影响到之前客户端初始化的代码，而且，这个初始化的过程非常清晰简单。</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/04/java-web知识体系/" itemprop="url">
                  java-web知识体系
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-05-04T23:05:21+08:00" content="2016-05-04">
              2016-05-04
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h2 id="一张java-web知识体系思维导图"><a href="#一张java-web知识体系思维导图" class="headerlink" title="一张java web知识体系思维导图"></a>一张java web知识体系思维导图</h2><p>就是稍微旧了点</p>
<p><img src="/images/java-web.png" alt=""></p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/03/springmvc-rest-api-versioning/" itemprop="url">
                  springmvc rest api versioning
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-05-03T23:34:35+08:00" content="2016-05-03">
              2016-05-03
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p><a href="https://github.com/mindhaq/restapi-versioning-spring.git" target="_blank" rel="external">https://github.com/mindhaq/restapi-versioning-spring.git</a><br><a href="https://github.com/augusto/restVersioning.git" target="_blank" rel="external">https://github.com/augusto/restVersioning.git</a></p>
<p>这两个git项目里提供了4种在springmvc中进行api版本控制的处理方法。</p>
<ol>
<li><p>/api/v1/xxx<br>controller中的方法注解写法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@ResponseBody&#10;@RequestMapping(value = &#34;/apiurl/&#123;version&#125;/hello&#34;, method = GET, produces = APPLICATION_JSON_VALUE)&#10;public Hello sayHelloWorldUrl(@PathVariable final ValidVersion version) &#123;&#10;    return new Hello();&#10;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>/api/xxx<br>在header中添加”X-API-Version”:”v1”来进行版本请求的区别<br>controller中的方法注解写法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@ResponseBody&#10;@RequestMapping(value = &#34;/apiheader/hello&#34;, method = GET, produces = APPLICATION_JSON_VALUE)&#10;public Hello sayHelloWorldHeader(@RequestHeader(&#34;X-API-Version&#34;) final ValidVersion version) &#123;&#10;    return new Hello();&#10;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>/api/xxx<br>在header中添加Accept: “application/vnd.company.app-v1+json”来进行版本区别<br>controller中的方法注解写法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@ResponseBody&#10;@RequestMapping(&#10;    value = &#34;/apiaccept/hello&#34;, method = GET,&#10;    produces = &#123;&#34;application/vnd.company.app-v1+json&#34;, &#34;application/vnd.company.app-v2+json&#34;&#125;&#10;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>/api/xxx<br>在header中添加Accept: “application/vnd.company.app-v1+json”来进行版本区别<br>controller写法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@Controller&#10;@VersionedResource(media = &#34;application/vnd.app.resource&#34;)&#10;public class TestController &#123;&#10;&#10;    @RequestMapping(value = &#123;&#34;/resource&#34;&#125;, method = RequestMethod.GET)&#10;    @VersionedResource(from = &#34;1.0&#34;, to = &#34;1.0&#34;)&#10;    @ResponseBody&#10;    public Resource getResource_v1() &#123;&#10;        return new Resource(&#34;1.0&#34;);&#10;    &#125;&#10;&#10;    @RequestMapping(value = &#123;&#34;/resource&#34;&#125;, method = RequestMethod.GET)&#10;    @VersionedResource(from = &#34;2.0&#34;)&#10;    @ResponseBody&#10;    public Resource getResource_v2_onwards() &#123;&#10;        return new Resource(&#34;2.0&#34;);&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/04/25/centos6环境下配置mysql主从同步/" itemprop="url">
                  centos6环境下配置mysql主从同步
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-04-25T21:22:51+08:00" content="2016-04-25">
              2016-04-25
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h2 id="1、主从服务器分别作以下操作："><a href="#1、主从服务器分别作以下操作：" class="headerlink" title="1、主从服务器分别作以下操作："></a>1、主从服务器分别作以下操作：</h2><p>  1.1、版本一致<br>  1.2、初始化表，并在后台启动mysql<br>  1.3、修改root的密码</p>
<h2 id="2、修改主服务器master"><a href="#2、修改主服务器master" class="headerlink" title="2、修改主服务器master:"></a>2、修改主服务器master:</h2><p>   #vi /etc/my.cnf<br>       [mysqld]<br>       log-bin=mysql-bin   //[必须]启用二进制日志<br>       server-id=222      //[必须]服务器唯一ID，默认是1，一般取IP最后一段</p>
<h2 id="3、修改从服务器slave"><a href="#3、修改从服务器slave" class="headerlink" title="3、修改从服务器slave:"></a>3、修改从服务器slave:</h2><p>   #vi /etc/my.cnf<br>       [mysqld]<br>       log-bin=mysql-bin   //[不是必须]启用二进制日志<br>       server-id=226      //[必须]服务器唯一ID，默认是1，一般取IP最后一段</p>
<h2 id="4、重启两台服务器的mysql"><a href="#4、重启两台服务器的mysql" class="headerlink" title="4、重启两台服务器的mysql"></a>4、重启两台服务器的mysql</h2><pre><code>/etc/init.d/mysql restart
or：
service mysqld restart
</code></pre><h2 id="5、在主服务器上建立帐户并授权slave"><a href="#5、在主服务器上建立帐户并授权slave" class="headerlink" title="5、在主服务器上建立帐户并授权slave:"></a>5、在主服务器上建立帐户并授权slave:</h2><p>  #mysql -uroot -proot<br>   mysql&gt;GRANT REPLICATION SLAVE ON <em>.</em> to ‘mysync’@’%’ identified by ‘root’; //一般不用root帐号，%表示所有客户端都可能连，只要帐号，密码正确，此处可用具体客户端IP代替，如192.168.145.226，加强安全。</p>
<h2 id="6、登录主服务器的mysql，查询master的状态"><a href="#6、登录主服务器的mysql，查询master的状态" class="headerlink" title="6、登录主服务器的mysql，查询master的状态"></a>6、登录主服务器的mysql，查询master的状态</h2><p>   mysql&gt;show master status;<br>   +——————+———-+————–+——————+<br>   | File             | Position | Binlog_Do_DB | Binlog_Ignore_DB |<br>   +——————+———-+————–+——————+<br>   | mysql-bin.000004 |      308 |              |                  |<br>   +——————+———-+————–+——————+<br>   1 row in set (0.00 sec)<br>   注：执行完此步骤后不要再操作主服务器MYSQL，防止主服务器状态值变化</p>
<h2 id="7、配置从服务器Slave："><a href="#7、配置从服务器Slave：" class="headerlink" title="7、配置从服务器Slave："></a>7、配置从服务器Slave：</h2><p>   mysql&gt;change master to master_host=’192.168.145.222’,master_user=’mysync’,master_password=’root’, master_log_file=’mysql-bin.000004’,master_log_pos=308;   //注意不要断开，308数字前后无单引号。</p>
<p>   Mysql&gt;start slave;    //启动从服务器复制功能</p>
<h2 id="8、检查从服务器复制功能状态："><a href="#8、检查从服务器复制功能状态：" class="headerlink" title="8、检查从服务器复制功能状态："></a>8、检查从服务器复制功能状态：</h2><p>   mysql&gt; show slave status\G</p>
<p>   <strong><strong><strong><strong><strong><strong><em>*</em></strong></strong></strong></strong></strong></strong> 1. row <strong><strong><strong><strong><strong><strong><em>*</em></strong></strong></strong></strong></strong></strong></p>
<pre><code>Slave_IO_State: Waiting for master to send event
Master_Host: 192.168.2.222  //主服务器地址
Master_User: mysync   //授权帐户名，尽量避免使用root
Master_Port: 3306    //数据库端口，部分版本没有此行
Connect_Retry: 60
Master_Log_File: mysql-bin.000004
Read_Master_Log_Pos: 600     //#同步读取二进制日志的位置，大于等于Exec_Master_Log_Pos
Relay_Log_File: ddte-relay-bin.000003
Relay_Log_Pos: 251
Relay_Master_Log_File: mysql-bin.000004
Slave_IO_Running: Yes    //此状态必须YES
Slave_SQL_Running: Yes     //此状态必须YES
      ......
</code></pre><p>注：Slave_IO及Slave_SQL进程必须正常运行，即YES状态，否则都是错误的状态(如：其中一个NO均属错误)。</p>
<p>以上操作过程，主从服务器配置完成。</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/04/25/centos6下安装配置mysql，并开启mysql的远程登录/" itemprop="url">
                  centos6下安装配置mysql，并开启mysql的远程登录
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-04-25T21:00:38+08:00" content="2016-04-25">
              2016-04-25
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h2 id="安装："><a href="#安装：" class="headerlink" title="安装："></a>安装：</h2><h3 id="查看是否已安装mysql："><a href="#查看是否已安装mysql：" class="headerlink" title="查看是否已安装mysql："></a>查看是否已安装mysql：</h3><p>yum list installed | grep mysql</p>
<h3 id="如果已安装，如下一次卸载："><a href="#如果已安装，如下一次卸载：" class="headerlink" title="如果已安装，如下一次卸载："></a>如果已安装，如下一次卸载：</h3><p>yum -y remove mysql-libs.x86_64</p>
<h3 id="查看可用mysql："><a href="#查看可用mysql：" class="headerlink" title="查看可用mysql："></a>查看可用mysql：</h3><p>yum list | grep mysql 或 yum -y list mysql*</p>
<h3 id="安装mysql："><a href="#安装mysql：" class="headerlink" title="安装mysql："></a>安装mysql：</h3><p>yum -y install mysql-server mysql mysql-devel</p>
<h3 id="查看已安装的mysql状态："><a href="#查看已安装的mysql状态：" class="headerlink" title="查看已安装的mysql状态："></a>查看已安装的mysql状态：</h3><p>rpm -qi mysql-server</p>
<h3 id="安装后一开始登陆不上的问题：在进入mysql工具时，总是有错误提示"><a href="#安装后一开始登陆不上的问题：在进入mysql工具时，总是有错误提示" class="headerlink" title="安装后一开始登陆不上的问题：在进入mysql工具时，总是有错误提示:"></a>安装后一开始登陆不上的问题：在进入mysql工具时，总是有错误提示:</h3><p>mysql -u root -p<br>Enter password:<br>ERROR 1045 (28000): Access denied for user ‘root’@’localhost’ (using password: NO)</p>
<h3 id="解决：方法操作很简单，如下："><a href="#解决：方法操作很简单，如下：" class="headerlink" title="解决：方法操作很简单，如下："></a>解决：方法操作很简单，如下：</h3><p>/etc/init.d/mysql stop<br>mysqld_safe –user=mysql –skip-grant-tables –skip-networking &amp;<br>mysql -u root mysql<br>mysql&gt; UPDATE user SET Password=PASSWORD(‘root’) where USER=’root’ and host=’root’ or host=’localhost’;//把空的用户密码都修改成非空的密码就行了。<br>mysql&gt; FLUSH PRIVILEGES;<br>mysql&gt; quit<br>/etc/init.d/mysqld restart<br>mysql -uroot -p<br>Enter password: &lt;输入新设的密码newpassword&gt;</p>
<h2 id="开启远程连接"><a href="#开启远程连接" class="headerlink" title="开启远程连接"></a>开启远程连接</h2><h3 id="设置任意ip可以使用root账户和root密码远程登录"><a href="#设置任意ip可以使用root账户和root密码远程登录" class="headerlink" title="设置任意ip可以使用root账户和root密码远程登录"></a>设置任意ip可以使用root账户和root密码远程登录</h3><p>grant all privileges  on <em>.</em> to root@’%’ identified by “root”;</p>
<h3 id="刷新"><a href="#刷新" class="headerlink" title="刷新"></a>刷新</h3><p>FLUSH PRIVILEGES;</p>
<h3 id="重启："><a href="#重启：" class="headerlink" title="重启："></a>重启：</h3><p>service mysqld restart</p>
<p>done！</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/04/09/springboot-shiro-redis-rediscluster-sso-在springboot项目中接入shiro/" itemprop="url">
                  [springboot+shiro+redis+rediscluster+sso]在springboot项目中接入shiro
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-04-09T12:52:53+08:00" content="2016-04-09">
              2016-04-09
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>在之前的文章中，分别介绍了springboot启动，在springboot中使用redis作为缓存，在springboot中使用jpa和mybatis，现在将开始一个更大的综合工程：一步步介绍在springboot中使用shiro+redis-cluster+cookie实现一个跨域单点登录的方案。</p>
<p>现在开始是第一篇：在springboot项目中接入shiro</p>
<h2 id="引入shiro的maven依赖"><a href="#引入shiro的maven依赖" class="headerlink" title="引入shiro的maven依赖"></a>引入shiro的maven依赖</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;dependency&#62;&#10;    &#60;groupId&#62;org.apache.shiro&#60;/groupId&#62;&#10;    &#60;artifactId&#62;shiro-core&#60;/artifactId&#62;&#10;    &#60;version&#62;1.2.3&#60;/version&#62;&#10;&#60;/dependency&#62;&#10;&#60;dependency&#62;&#10;    &#60;groupId&#62;org.apache.shiro&#60;/groupId&#62;&#10;    &#60;artifactId&#62;shiro-spring&#60;/artifactId&#62;&#10;    &#60;version&#62;1.2.3&#60;/version&#62;&#10;&#60;/dependency&#62;&#10;&#60;dependency&#62;&#10;    &#60;groupId&#62;org.apache.shiro&#60;/groupId&#62;&#10;    &#60;artifactId&#62;shiro-web&#60;/artifactId&#62;&#10;    &#60;version&#62;1.2.3&#60;/version&#62;&#10;&#60;/dependency&#62;&#10;&#60;dependency&#62;&#10;    &#60;groupId&#62;org.apache.shiro&#60;/groupId&#62;&#10;    &#60;artifactId&#62;shiro-ehcache&#60;/artifactId&#62;&#10;    &#60;version&#62;1.2.3&#60;/version&#62;&#10;&#60;/dependency&#62;</span><br></pre></td></tr></table></figure>
<h2 id="程序具体实现"><a href="#程序具体实现" class="headerlink" title="程序具体实现"></a>程序具体实现</h2><h3 id="首先，需要一个shiro的配置文件，这里使用的是ymal配置。配置文件：application-yml"><a href="#首先，需要一个shiro的配置文件，这里使用的是ymal配置。配置文件：application-yml" class="headerlink" title="首先，需要一个shiro的配置文件，这里使用的是ymal配置。配置文件：application.yml"></a>首先，需要一个shiro的配置文件，这里使用的是ymal配置。配置文件：application.yml</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shiro:&#10;  realm: com.xxx.xxx.config.security.MyRealm&#10;  loginUrl: /view/sign-in.html&#10;  successUrl: /item.html&#10;  unauthorizedUrl: /forbidden.html&#10;  filterChainDefinitions:&#10;    &#34;/login&#34;: anon&#10;    &#34;/static/**&#34;: anon&#10;    &#34;/bower_components/**&#34;: anon&#10;    &#34;/logout&#34;: logout&#10;    &#34;/**&#34;: authc</span><br></pre></td></tr></table></figure>
<p>说明：<br>realm: com.xxx.xxx.config.security.MyRealm<br>Realm，在shiro中相当于数据源，shiro的其他核心组件需要获取用户和认证数据，就是从Realm获取。<br>为了获得更好的自定义功能，通常我们会自己实现一个Realm.<br>所以这里使用realm: com.xxx.xxx.config.security.MyRealm配置了一个自定义的Realm。<br>loginUrl，定义了需要认证用户时，跳转到的登录页面<br>successUrl，定义登录成功后跳转的页面。通常也可以在自己登录认证方法里redirect到需要的页面。<br>unauthorizedUrl，定义未认证时显示的页面。<br>filterChainDefinitions，定义哪些路径应该做何种过滤策略。<br>anon，logout，authc这些都是shiro默认实现的过滤器filter。<br>anon表示可以匿名访问的路径，authc表示需要登录认证的路径</p>
<p>过滤器链使用最先匹配返回策略，所以我们需要把不需要认证即可访问的路径放在前面。</p>
<h3 id="下面是自己实现的自定义Realm：MyRealm"><a href="#下面是自己实现的自定义Realm：MyRealm" class="headerlink" title="下面是自己实现的自定义Realm：MyRealm"></a>下面是自己实现的自定义Realm：MyRealm</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import org.apache.shiro.authc.AuthenticationException;&#10;import org.apache.shiro.authc.AuthenticationInfo;&#10;import org.apache.shiro.authc.AuthenticationToken;&#10;import org.apache.shiro.authc.SimpleAuthenticationInfo;&#10;import org.apache.shiro.authc.UsernamePasswordToken;&#10;import org.apache.shiro.authz.AuthorizationInfo;&#10;import org.apache.shiro.authz.SimpleAuthorizationInfo;&#10;import org.apache.shiro.realm.AuthorizingRealm;&#10;import org.apache.shiro.subject.PrincipalCollection;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;&#10;import com.xxx.model.base.UserDTO;&#10;import com.xxx.remote.base.UserRemote;&#10;&#10;public class MyRealm extends AuthorizingRealm &#123;&#10;    @Autowired UserRemote userService;&#10;&#10;    @Override&#10;    protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principals) &#123;&#10;        UserDTO user = (UserDTO) principals.getPrimaryPrincipal();&#10;        SimpleAuthorizationInfo info = new SimpleAuthorizationInfo();&#10;        List&#60;String&#62; roles = userService.findByUserId(user.getId());&#10;        info.addRoles(roles);&#10;        return info;&#10;    &#125;&#10;&#10;    @Override&#10;    protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken token) throws AuthenticationException &#123;&#10;        UsernamePasswordToken usernamePasswordToken = (UsernamePasswordToken) token;&#10;        String username = usernamePasswordToken.getUsername();&#10;        UserDTO user = userService.findUserByName(username);&#10;        if (null != user) &#123;&#10;            CredentialsInfoHolder cih = new CredentialsInfoHolder(user.getPassword(), user.getSalt());&#10;            return new SimpleAuthenticationInfo(user, cih, getName());&#10;        &#125;&#10;        return null;&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>MyRealm集成AuthorizingRealm，需要重写AuthorizingRealm的两个方法：doGetAuthorizationInfo，doGetAuthenticationInfo。<br>AuthorizationInfo represents a single Subject’s stored authorization data (roles, permissions, etc) used during authorization (access control) checks only. </p>
<p>doGetAuthorizationInfo方法返回一个AuthorizationInfo，AuthorizationInfo对象是一个单一的Subject对象，存储着用户的授权数据，只用于授权检查时使用。<br>doGetAuthenticationInfo方法，针对给定的用户，获取对应用户的认证数据，提供给认证用户身份时使用。</p>
<p>例子中UserRemote userService是提供用户数据的具体service服务。</p>
<h3 id="有了数据源realm和shiro配置文件，现在开始接入shiro配置到spring容器"><a href="#有了数据源realm和shiro配置文件，现在开始接入shiro配置到spring容器" class="headerlink" title="有了数据源realm和shiro配置文件，现在开始接入shiro配置到spring容器"></a>有了数据源realm和shiro配置文件，现在开始接入shiro配置到spring容器</h3><h4 id="springboot-shiro配置类：ShiroAutoConfig-java"><a href="#springboot-shiro配置类：ShiroAutoConfig-java" class="headerlink" title="springboot shiro配置类：ShiroAutoConfig.java"></a>springboot shiro配置类：ShiroAutoConfig.java</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import org.apache.shiro.mgt.DefaultSecurityManager;&#10;import org.apache.shiro.realm.Realm;&#10;import org.apache.shiro.spring.web.ShiroFilterFactoryBean;&#10;import org.springframework.beans.BeanUtils;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;&#10;import org.springframework.boot.context.properties.EnableConfigurationProperties;&#10;import org.springframework.context.annotation.Bean;&#10;import org.springframework.context.annotation.Configuration;&#10;import org.springframework.context.annotation.DependsOn;&#10;import org.springframework.context.annotation.Import;&#10;&#10;import com.xxx.xxx.config.security.MyRealm;&#10;&#10;@Configuration&#10;@EnableConfigurationProperties(ShiroProperties.class)&#10;@Import(ShiroManager.class)&#10;public class ShiroAutoConfig &#123;&#10;    @Autowired private ShiroProperties properties;&#10;&#10;    @Bean(name = &#34;realm&#34;)&#10;    @DependsOn(&#34;lifecycleBeanPostProcessor&#34;)&#10;    @ConditionalOnMissingBean&#10;    public MyRealm realm() &#123;&#10;        Class&#60;?&#62; relmClass = properties.getRealm();&#10;        MyRealm r = (MyRealm) BeanUtils.instantiate(relmClass);&#10;        HashedCredentialsMatcher credentialsMatcher = new HashedCredentialsMatcher();&#10;        credentialsMatcher.setHashAlgorithmName(Sha256Hash.ALGORITHM_NAME);&#10;        r.setCredentialsMatcher(credentialsMatcher);&#10;        return r;&#10;    &#125;&#10;&#10;    @Bean(name = &#34;shiroFilter&#34;)&#10;    @DependsOn(&#34;securityManager&#34;)&#10;    @ConditionalOnMissingBean&#10;    public ShiroFilterFactoryBean getShiroFilterFactoryBean(DefaultSecurityManager securityManager, Realm realm) &#123;&#10;        MyRealm myRealm = (MyRealm) realm;&#10;        securityManager.setRealm(myRealm);&#10;        ShiroFilterFactoryBean shiroFilter = new ShiroFilterFactoryBean();&#10;        shiroFilter.setSecurityManager(securityManager);&#10;        shiroFilter.setLoginUrl(properties.getLoginUrl());&#10;        shiroFilter.setSuccessUrl(properties.getSuccessUrl());&#10;        shiroFilter.setUnauthorizedUrl(properties.getUnauthorizedUrl());&#10;        shiroFilter.setFilterChainDefinitionMap(properties.getFilterChainDefinitions());&#10;        return shiroFilter;&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>这里例子里说明，我们需要提供realm和shiroFilter两个bean配置给spring容器。<br>getShiroFilterFactoryBean方法返回ShiroFilterFactoryBean，将会把yml里面的配置读取到ShiroFilterFactoryBean中，然后把realm设置进securityManager。<br>yml配置有ShiroProperties类持有并提供给ShiroFilterFactoryBean。<br>当然，还需要配置几个其他配置，都在ShiroManager配置好了。</p>
<h4 id="ShiroProperties："><a href="#ShiroProperties：" class="headerlink" title="ShiroProperties："></a>ShiroProperties：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import java.util.Map;&#10;import org.springframework.boot.context.properties.ConfigurationProperties;&#10;/**&#10; * Configuration properties for Shiro.&#10; */&#10;@ConfigurationProperties(prefix = &#34;shiro&#34;)&#10;public class ShiroProperties &#123;&#10;    private Class&#60;?&#62; realm;&#10;    private String loginUrl;&#10;    private String successUrl;&#10;    private String unauthorizedUrl;&#10;    private Map&#60;String, String&#62; filterChainDefinitions;&#10;&#10;&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ShiroManager："><a href="#ShiroManager：" class="headerlink" title="ShiroManager："></a>ShiroManager：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import org.apache.shiro.cache.CacheManager;&#10;import org.apache.shiro.mgt.DefaultSecurityManager;&#10;import org.apache.shiro.session.mgt.SessionManager;&#10;import org.apache.shiro.session.mgt.eis.SessionDAO;&#10;import org.apache.shiro.spring.LifecycleBeanPostProcessor;&#10;import org.apache.shiro.spring.security.interceptor.AuthorizationAttributeSourceAdvisor;&#10;import org.apache.shiro.web.mgt.DefaultWebSecurityManager;&#10;import org.apache.shiro.web.session.mgt.DefaultWebSessionManager;&#10;import org.springframework.aop.framework.autoproxy.DefaultAdvisorAutoProxyCreator;&#10;import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;&#10;import org.springframework.context.annotation.Bean;&#10;import org.springframework.context.annotation.DependsOn;&#10;&#10;/**&#10; * Shiro Config Manager.&#10; */&#10;public class ShiroManager &#123;&#10;    /**&#10;     * &#20445;&#35777;&#23454;&#29616;&#20102;Shiro&#20869;&#37096;lifecycle&#20989;&#25968;&#30340;bean&#25191;&#34892;&#10;     */&#10;    @Bean(name = &#34;lifecycleBeanPostProcessor&#34;)&#10;    @ConditionalOnMissingBean&#10;    public LifecycleBeanPostProcessor lifecycleBeanPostProcessor() &#123;&#10;        return new LifecycleBeanPostProcessor();&#10;    &#125;&#10;    @Bean(name = &#34;defaultAdvisorAutoProxyCreator&#34;)&#10;    @ConditionalOnMissingBean&#10;    @DependsOn(&#34;lifecycleBeanPostProcessor&#34;)&#10;    public DefaultAdvisorAutoProxyCreator defaultAdvisorAutoProxyCreator() &#123;&#10;        DefaultAdvisorAutoProxyCreator defaultAdvisorAutoProxyCreator = new DefaultAdvisorAutoProxyCreator();&#10;        defaultAdvisorAutoProxyCreator.setProxyTargetClass(true);&#10;        return defaultAdvisorAutoProxyCreator;&#10;&#10;    &#125;&#10;    /**&#10;     * &#29992;&#25143;&#25480;&#26435;&#20449;&#24687;Cache&#10;     */&#10;    @Bean(name = &#34;cacheManager&#34;)&#10;    @ConditionalOnMissingBean&#10;    public CacheManager cacheManager() &#123;&#10;        return new MemoryConstrainedCacheManager();&#10;    &#125;&#10;    @Bean(name = &#34;securityManager&#34;)&#10;    @ConditionalOnMissingBean&#10;    public DefaultSecurityManager securityManager(CacheManager cacheManager) &#123;&#10;        DefaultSecurityManager sm = new DefaultWebSecurityManager();&#10;        sm.setCacheManager(cacheManager);&#10;        return sm;&#10;    &#125;&#10;    @Bean&#10;    @ConditionalOnMissingBean&#10;    public AuthorizationAttributeSourceAdvisor getAuthorizationAttributeSourceAdvisor(DefaultSecurityManager securityManager) &#123;&#10;        AuthorizationAttributeSourceAdvisor aasa = new AuthorizationAttributeSourceAdvisor();&#10;        aasa.setSecurityManager(securityManager);&#10;        return new AuthorizationAttributeSourceAdvisor();&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>CacheManager负责缓存，这里简单的使用默认的内存缓存管理MemoryConstrainedCacheManager。<br>如果需要ehcache，或者使用redis作为缓存，则只需要实现自己的CacheManager和SessionManager即可。</p>
<p>至此，springboot中引入shiro就完成了，其他更多具体使用方法，根据具体而定。</p>
<h3 id="这里简单的提供一下在mvc的controller中做登录和登出怎么做。"><a href="#这里简单的提供一下在mvc的controller中做登录和登出怎么做。" class="headerlink" title="这里简单的提供一下在mvc的controller中做登录和登出怎么做。"></a>这里简单的提供一下在mvc的controller中做登录和登出怎么做。</h3><p>LoginController：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import javax.servlet.ServletException;&#10;import javax.servlet.http.HttpServletRequest;&#10;import javax.servlet.http.HttpServletResponse;&#10;&#10;import org.apache.shiro.SecurityUtils;&#10;import org.apache.shiro.authc.AuthenticationException;&#10;import org.apache.shiro.authc.IncorrectCredentialsException;&#10;import org.apache.shiro.authc.UnknownAccountException;&#10;import org.apache.shiro.authc.UsernamePasswordToken;&#10;import org.apache.shiro.subject.Subject;&#10;import org.springframework.stereotype.Controller;&#10;import org.springframework.web.bind.annotation.RequestMapping;&#10;import org.springframework.web.bind.annotation.ResponseBody;&#10;&#10;@Controller&#10;public class LoginController &#123;&#10;    @RequestMapping(&#34;/login&#34;)&#10;    @ResponseBody&#10;    public void login(HttpServletRequest req, HttpServletResponse resp, String username, String password) throws ServletException, IOException &#123;&#10;        Subject subject = SecurityUtils.getSubject();&#10;        String error = null;&#10;        UsernamePasswordToken token = new UsernamePasswordToken(username, password);&#10;        try &#123;&#10;            subject.login(token);&#10;        &#125; catch (UnknownAccountException e) &#123;&#10;            error = &#34;&#29992;&#25143;&#21517;/&#23494;&#30721;&#38169;&#35823;&#34;;&#10;        &#125; catch (IncorrectCredentialsException e) &#123;&#10;            error = &#34;&#29992;&#25143;&#21517;/&#23494;&#30721;&#38169;&#35823;&#34;;&#10;        &#125; catch (AuthenticationException e) &#123;&#10;            // &#20854;&#20182;&#38169;&#35823;&#65292;&#27604;&#22914;&#38145;&#23450;&#65292;&#22914;&#26524;&#24819;&#21333;&#29420;&#22788;&#29702;&#35831;&#21333;&#29420;catch&#22788;&#29702;&#10;            error = &#34;&#20854;&#20182;&#38169;&#35823;&#65306;&#34; + e.getMessage();&#10;        &#125;&#10;        if (error != null) &#123;// &#20986;&#38169;&#20102;&#65292;&#36820;&#22238;&#30331;&#24405;&#39029;&#38754;&#10;            req.setAttribute(&#34;error&#34;, error);&#10;            resp.sendRedirect(&#34;/forbidden.html&#34;);&#10;        &#125; else &#123;// &#30331;&#24405;&#25104;&#21151;&#10;            resp.sendRedirect(&#34;/index.html&#34;);// &#35774;&#32622;&#36339;&#36716;&#30340;&#39029;&#38754;&#10;        &#125;&#10;    &#125;&#10;    @RequestMapping(value = &#34;/logout&#34;)&#10;    @ResponseBody&#10;    public void logout(HttpServletRequest req, HttpServletResponse resp) throws IOException &#123;&#10;&#10;        Subject currentUser = SecurityUtils.getSubject();&#10;        currentUser.logout();&#10;        resp.sendRedirect(&#34;/index.html&#34;);&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>done!</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/04/09/springboot-在spring项目中连接数据库以及spring-datajpa和mybatis的使用/" itemprop="url">
                  [springboot]在spring项目中连接数据库以及spring-datajpa和mybatis的使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-04-09T11:37:07+08:00" content="2016-04-09">
              2016-04-09
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h2 id="1-在项目中添加数据库配置（添加数据源等配置）"><a href="#1-在项目中添加数据库配置（添加数据源等配置）" class="headerlink" title="1.在项目中添加数据库配置（添加数据源等配置）"></a>1.在项目中添加数据库配置（添加数据源等配置）</h2><p>spring boot推崇约定大于配置，即是说，即使你什么也配置，spring boot也会为你添加一些约定俗成的默认配置。<br>比如数据源dataSource就是，如果你的spring boot项目没有数据源配置，那么默认情况下项目启动会失败，提示你配置数据源。<br>如果你的项目真的不需要数据源，没有数据库url等配置，那么你需要显式的使用注解配置告诉spring boot。<br>在启动类添加注解：<br>@EnableAutoConfiguration(exclude = {DataSourceAutoConfiguration.class, HibernateJpaAutoConfiguration.class}</p>
<p>回到数据源配置上来。<br>首先,在配置文件application.properties里面配置数据库url<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.datasource.url=jdbc:mysql://localhost/dbname&#10;spring.datasource.username=username&#10;spring.datasource.password=password&#10;spring.datasource.driver-class-name=com.mysql.jdbc.Driver</span><br></pre></td></tr></table></figure></p>
<p>使用mysql数据库，还需要添加maven依赖<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;dependency&#62;&#10;    &#60;groupId&#62;mysql&#60;/groupId&#62;&#10;    &#60;artifactId&#62;mysql-connector-java&#60;/artifactId&#62;&#10;&#60;/dependency&#62;</span><br></pre></td></tr></table></figure></p>
<p>然后，添加数据库配置类</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import javax.sql.DataSource;&#10;import org.apache.ibatis.session.ExecutorType;&#10;import org.apache.ibatis.session.SqlSessionFactory;&#10;import org.mybatis.spring.SqlSessionFactoryBean;&#10;import org.mybatis.spring.SqlSessionTemplate;&#10;import org.mybatis.spring.annotation.MapperScan;&#10;import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;&#10;import org.springframework.context.annotation.Bean;&#10;import org.springframework.context.annotation.Configuration;&#10;import org.springframework.core.io.ClassPathResource;&#10;&#10;@Configuration&#10;public class DatabaseConfig &#123;&#10;    @Bean&#10;    public SqlSessionFactory sqlSessionFactory(DataSource dataSource) throws Exception &#123;&#10;        final SqlSessionFactoryBean sessionFactory = new SqlSessionFactoryBean();&#10;        sessionFactory.setDataSource(dataSource);&#10;        return sessionFactory.getObject();&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>如此，项目中就有了数据源</p>
<h2 id="2-在项目中使用spring-data-jpa"><a href="#2-在项目中使用spring-data-jpa" class="headerlink" title="2.在项目中使用spring-data-jpa"></a>2.在项目中使用spring-data-jpa</h2><p>添加maven依赖：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;dependency&#62;&#10;    &#60;groupId&#62;org.springframework.boot&#60;/groupId&#62;&#10;    &#60;artifactId&#62;spring-boot-starter-data-jpa&#60;/artifactId&#62;&#10;&#60;/dependency&#62;</span><br></pre></td></tr></table></figure></p>
<p>添加Repository类：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import org.springframework.data.domain.Page;&#10;import org.springframework.data.domain.Pageable;&#10;import org.springframework.data.repository.CrudRepository;&#10;&#10;import com.xxx.xxx.model.User;&#10;&#10;public interface UserRepository extends CrudRepository&#60;User, Long&#62; &#123;&#10;&#10;    Page&#60;User&#62; findAll(Pageable pageable);&#10;    Page&#60;User&#62; findByNameContainingAndTypeContainingAllIgnoringCase(String name, Integer type, Pageable pageable);&#10;    User findByNameAndTypeAllIgnoringCase(String name, Integer type);&#10;    User findByName(String name);&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>pring-data-jpa的使用极其简单，只需要配置好对应的Repository接口即可，不需要操作的具体实现<br>这个例子中，UserRepository继承了CrudRepository，默认即拥有基础的增删改查接口。<br>然后你只需添加一些你需要的额外接口方法。<br>同样你只需按照其约定的方式写好接口方法，而不需要具体实现。</p>
<p>使用：<br>在需要的地方注解注入即可。<br>@Autowrite UserRepository userRepository;</p>
<h2 id="3-在项目中使用mybatis"><a href="#3-在项目中使用mybatis" class="headerlink" title="3.在项目中使用mybatis"></a>3.在项目中使用mybatis</h2><p>添加maven依赖：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;dependency&#62;&#10;    &#60;groupId&#62;org.mybatis&#60;/groupId&#62;&#10;    &#60;artifactId&#62;mybatis&#60;/artifactId&#62;&#10;    &#60;version&#62;3.2.3&#60;/version&#62;&#10;&#60;/dependency&#62;&#10;&#60;dependency&#62;&#10;    &#60;groupId&#62;org.mybatis&#60;/groupId&#62;&#10;    &#60;artifactId&#62;mybatis-spring&#60;/artifactId&#62;&#10;    &#60;version&#62;1.2.2&#60;/version&#62;&#10;&#60;/dependency&#62;</span><br></pre></td></tr></table></figure></p>
<p>mybatis的使用，和jpa一样，默认也是只需要定义Mapper接口即可，不需要实现类，但需要具体实现的sql。<br>你可以使用xml写sql，或者在接口上面使用注解注入sql两种方式。</p>
<p>注解sql例子：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public interface ItemMapper &#123;&#10;    @Select(&#34;select * from item&#34;)&#10;    List&#60;Item&#62; findAll();&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>而如果是xml配置文件的话，则需要mapper xml中的sql id和Mapper接口中的接口方法名称一致。</p>
<p>当然，如果习惯了使用具体实现，使用SqlSessionTemplate，也可以实现。<br>首先需要改一下DatabaseConfig配置类：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import javax.sql.DataSource;&#10;import org.apache.ibatis.session.ExecutorType;&#10;import org.apache.ibatis.session.SqlSessionFactory;&#10;import org.mybatis.spring.SqlSessionFactoryBean;&#10;import org.mybatis.spring.SqlSessionTemplate;&#10;import org.mybatis.spring.annotation.MapperScan;&#10;import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;&#10;import org.springframework.context.annotation.Bean;&#10;import org.springframework.context.annotation.Configuration;&#10;import org.springframework.core.io.ClassPathResource;&#10;&#10;@Configuration&#10;@MapperScan(basePackages=&#34;com.xxx.xxx.mapper&#34;)&#10;public class DatabaseConfig &#123;&#10;    @Bean&#10;    public SqlSessionFactory sqlSessionFactory(DataSource dataSource) throws Exception &#123;&#10;        final SqlSessionFactoryBean sessionFactory = new SqlSessionFactoryBean();&#10;        sessionFactory.setDataSource(dataSource);&#10;        sessionFactory.setConfigLocation(new ClassPathResource(&#34;mybatis-config.xml&#34;));&#10;        return sessionFactory.getObject();&#10;    &#125;&#10;    @Bean&#10;    @ConditionalOnMissingBean&#10;    public SqlSessionTemplate sqlSessionTemplate(SqlSessionFactory sqlSessionFactory) &#123;&#10;        return new SqlSessionTemplate(sqlSessionFactory, ExecutorType.SIMPLE);&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>添加mybatis配置文件：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&#62;&#10;&#60;!DOCTYPE configuration&#10;        PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;&#10;        &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&#62;&#10;&#60;configuration&#62;&#10;    &#60;typeAliases&#62;&#10;        &#60;package name=&#34;com.xxx.xxx.model&#34;/&#62;&#10;    &#60;/typeAliases&#62;&#10;    &#60;mappers&#62;&#10;        &#60;mapper resource=&#34;mapper/xxxMapper.xml&#34;/&#62;&#10;    &#60;/mappers&#62;&#10;&#60;/configuration&#62;</span><br></pre></td></tr></table></figure></p>
<p>具体Mapper实现类：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@Component&#10;public class ItemMapper &#123;&#10;    @Autowired private SqlSessionTemplate sqlSessionTemplate;&#10;&#10;    public Item selectItemById(long id) &#123;&#10;        return this.sqlSessionTemplate.selectOne(&#34;selectItemById&#34;, id);&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>done！</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/04/09/spring-boot-springboot实践之在项目中使用spring-cache和redis实现缓存/" itemprop="url">
                  [spring-boot]springboot实践之在项目中使用spring-cache和redis实现缓存
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-04-09T10:43:01+08:00" content="2016-04-09">
              2016-04-09
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h2 id="1-首先需要准备一个redis服务端作为缓存"><a href="#1-首先需要准备一个redis服务端作为缓存" class="headerlink" title="1.首先需要准备一个redis服务端作为缓存"></a>1.首先需要准备一个redis服务端作为缓存</h2><p>redis下载安装启动，比较简单，请google之。</p>
<h2 id="2-项目依赖"><a href="#2-项目依赖" class="headerlink" title="2.项目依赖"></a>2.项目依赖</h2><p>使用spring boot和spring cache，需要springboot依赖<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;dependency&#62;&#10;    &#60;groupId&#62;org.springframework.boot&#60;/groupId&#62;&#10;    &#60;artifactId&#62;spring-boot-starter&#60;/artifactId&#62;&#10;&#60;/dependency&#62;</span><br></pre></td></tr></table></figure></p>
<p>连接redis，需要spring data redis和jedis包<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;dependency&#62;&#10;    &#60;groupId&#62;org.springframework.data&#60;/groupId&#62;&#10;    &#60;artifactId&#62;spring-data-redis&#60;/artifactId&#62;&#10;&#60;/dependency&#62;&#10;&#60;dependency&#62;&#10;    &#60;groupId&#62;redis.clients&#60;/groupId&#62;&#10;    &#60;artifactId&#62;jedis&#60;/artifactId&#62;&#10;&#60;/dependency&#62;</span><br></pre></td></tr></table></figure></p>
<h2 id="3-程序配置实现与使用"><a href="#3-程序配置实现与使用" class="headerlink" title="3.程序配置实现与使用"></a>3.程序配置实现与使用</h2><p>不同于spring使用xml配置文件来配置bean，spring boot使用java bean直接在java类中配置需要用到的Bean。</p>
<h3 id="添加redis-cache相关的config类，如下："><a href="#添加redis-cache相关的config类，如下：" class="headerlink" title="添加redis cache相关的config类，如下："></a>添加redis cache相关的config类，如下：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import org.springframework.cache.CacheManager;&#10;import org.springframework.cache.annotation.CachingConfigurerSupport;&#10;import org.springframework.cache.annotation.EnableCaching;&#10;import org.springframework.context.annotation.Bean;&#10;import org.springframework.context.annotation.Configuration;&#10;import org.springframework.data.redis.cache.RedisCacheManager;&#10;import org.springframework.data.redis.connection.RedisConnectionFactory;&#10;import org.springframework.data.redis.connection.jedis.JedisConnectionFactory;&#10;import org.springframework.data.redis.core.RedisTemplate;&#10;&#10;@Configuration&#10;@EnableCaching&#10;public class RedisCacheConfig extends CachingConfigurerSupport &#123;&#10;    @Bean&#10;    public JedisConnectionFactory redisConnectionFactory() &#123;&#10;        JedisConnectionFactory redisConnectionFactory = new JedisConnectionFactory();&#10;        redisConnectionFactory.setHostName(&#34;127.0.0.1&#34;);&#10;        redisConnectionFactory.setPort(6379);&#10;        return redisConnectionFactory;&#10;    &#125;&#10;    @Bean&#10;    public RedisTemplate&#60;String, String&#62; redisTemplate(RedisConnectionFactory cf) &#123;&#10;        RedisTemplate&#60;String, String&#62; redisTemplate = new RedisTemplate&#60;String, String&#62;();&#10;        redisTemplate.setConnectionFactory(cf);&#10;        return redisTemplate;&#10;    &#125;&#10;    @Bean(name = &#34;redisCacheManager&#34;)&#10;    public CacheManager cacheManager(RedisTemplate redisTemplate) &#123;&#10;        RedisCacheManager cacheManager = new RedisCacheManager(redisTemplate);&#10;        cacheManager.setDefaultExpiration(300);&#10;        return cacheManager;&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>@Configuration标记此java类为spring boot的配置类<br>@EnableCaching标记为项目启用缓存<br>@Bean，每个被此注解标记的方法都会配置一个bean，等同于xml配置中的<bean><br>从以上代码可以看到，使用spring cache和redis缓存，我们需要一个JedisConnectionFactory，一个RedisTemplate和一个CacheManager。<br>其中JedisConnectionFactory配置了redis服务的ip和端口，为了方便这里直接写在了程序里，可以移出去放到配置文件中读取。</bean></p>
<h3 id="如何使用？"><a href="#如何使用？" class="headerlink" title="如何使用？"></a>如何使用？</h3><p>使用非常简单，只需要在我们想要缓存的方法前加一个@Cacheable注解即可<br>下面是一个例子：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@Cacheable(value = &#34;find&#34;)&#10;public List&#60;Object&#62; find(Long id) &#123;&#10;    ...&#10;&#125;&#10;@CacheEvict(value = &#34;find&#34;, allEntries = true)&#10;public Object saveProject(Object object) &#123;&#10;    ...&#10;&#125;&#10;@CacheEvict(value = &#34;find&#34; , allEntries = true)&#10;public void deleteProject(Long id) &#123;&#10;    ...&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>这里@Cacheable标记的方法在首次调用后，将会将读取到的内容缓存到redis中，以后每次只要缓存中存在该缓存，读取都会从缓存中读取。<br>但如果实际数据改变了怎么办？<br>我查看spring cache的api后，没有适用的动态更新缓存的方法，所以这里适用了一种不怎么优雅的解决方案：<br>每次会对模型数据改变的方法，都清除一次缓存。清除后的第一次，查询会读取数据库，之后再缓存。<br>@CacheEvict标记的方法，表示将会清除缓存，value属性中配置了“find”，表示清除key为“find”的缓存数据。</p>
<p>这个方案不是很优雅，就是用起来简单，如果想更优雅的方案，应该要自己再实现一套自己可控的缓存程序。</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    

  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



        </div>

        


        

      </div>

      
        
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="/images/default_avatar.jpg" alt="Wanglv Yihua" itemprop="image"/>
          <p class="site-author-name" itemprop="name">Wanglv Yihua</p>
        </div>
        <p class="site-description motion-element" itemprop="description"></p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">22</span>
              <span class="site-state-item-name">文章</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            
              <span class="site-state-item-count">0</span>
              <span class="site-state-item-name">分類</span>
              
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">50</span>
              <span class="site-state-item-name">標籤</span>
              </a>
          </div>

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


      
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="icon-next-heart fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Wanglv Yihua</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 強力驅動
</div>

<div class="theme-info">
  主題 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  

  
    
    

  


  

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.2"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.2"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
<script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

<script type="text/javascript" src="/js/motion.js?v=0.4.5.2" id="motion.global"></script>


  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  

  <script type="text/javascript" src="/js/bootstrap.js"></script>

  
  

  
  

</body>
</html>
